"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("is-hotkey"),t=require("slate"),r="undefined"!=typeof navigator&&"undefined"!=typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,n="undefined"!=typeof navigator&&/Mac OS X/.test(navigator.userAgent),o="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),a="undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),i="undefined"!=typeof navigator&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])/i.test(navigator.userAgent),d={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",splitBlock:"shift?+enter",undo:"mod+z"},s={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},l={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},c=function(t){var r=d[t],o=s[t],a=l[t],i=r&&e.isKeyHotkey(r),c=o&&e.isKeyHotkey(o),f=a&&e.isKeyHotkey(a);return function(e){return!(!i||!i(e))||(!!(n&&c&&c(e))||!(n||!f||!f(e)))}},f={isBold:c("bold"),isCompose:c("compose"),isMoveBackward:c("moveBackward"),isMoveForward:c("moveForward"),isDeleteBackward:c("deleteBackward"),isDeleteForward:c("deleteForward"),isDeleteLineBackward:c("deleteLineBackward"),isDeleteLineForward:c("deleteLineForward"),isDeleteWordBackward:c("deleteWordBackward"),isDeleteWordForward:c("deleteWordForward"),isExtendBackward:c("extendBackward"),isExtendForward:c("extendForward"),isExtendLineBackward:c("extendLineBackward"),isExtendLineForward:c("extendLineForward"),isItalic:c("italic"),isMoveLineBackward:c("moveLineBackward"),isMoveLineForward:c("moveLineForward"),isMoveWordBackward:c("moveWordBackward"),isMoveWordForward:c("moveWordForward"),isRedo:c("redo"),isSplitBlock:c("splitBlock"),isTransposeCharacter:c("transposeCharacter"),isUndo:c("undo")};function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,d=e[Symbol.iterator]();!(n=(i=d.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==d.return||d.return()}finally{if(o)throw a}}return r}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=m(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,d=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){d=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(d)throw a}}}}var x="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,b=String.fromCharCode(32),D=!1;var O=function(e,t){var r=!1;switch(e){case"compositionend":return function(e){var t=e.detail;return"object"===u(t)&&"data"in t?t.data:null}(t);case"keypress":return 32!==t.which?null:(r=!0,b);case"textInput":var n=t.data;return n===b&&r?null:n;default:return null}};var k,N=function(e,t){var r;r=x&&"TextEvent"in window?O(e,t):function(e,t){if(D)return"compositionend"===e?t.data:null;switch(e){case"paste":return null;case"keypress":if(!function(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}(t)){if(t.char&&t.char.length>1)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return t.data;default:return null}}(e,t);var n=new CustomEvent("beforeinput",{detail:r});t.target&&t.target.dispatchEvent(n)},S=globalThis.Node,T=globalThis.Comment,C=globalThis.Element,M=globalThis.Text,F=globalThis.Range,B=globalThis.Selection,_=globalThis.StaticRange,P=function(e){return A(e)&&8===e.nodeType},R=function(e){return A(e)&&1===e.nodeType},A=function(e){return e instanceof Node},L=function(e){return A(e)&&3===e.nodeType},W=function(e){return e.clipboardData&&""!==e.clipboardData.getData("text/plain")&&1===e.clipboardData.types.length},I=function(e){var t=g(e,2),r=t[0],n=t[1];if(R(r)&&r.childNodes.length){var o=n===r.childNodes.length,a=o?"backward":"forward";for(r=j(r,o?n-1:n,a);R(r)&&r.childNodes.length;){var i=o?r.childNodes.length-1:0;r=j(r,i,a)}n=o&&null!=r.textContent?r.textContent.length:0}return[r,n]},j=function(e,t,r){for(var n=e.childNodes,o=n[t],a=t,i=!1,d=!1;(P(o)||R(o)&&0===o.childNodes.length||R(o)&&"false"===o.getAttribute("contenteditable"))&&(!i||!d);)a>=n.length?(i=!0,a=t-1,r="backward"):a<0?(d=!0,a=t+1,r="forward"):(o=n[a],a+="forward"===r?1:-1);return o},K=function e(t){var r="";if(L(t)&&t.nodeValue)return t.nodeValue;if(R(t)){for(var n=0,o=Array.from(t.childNodes);n<o.length;n++){r+=e(o[n])}var a=getComputedStyle(t).getPropertyValue("display");"block"!==a&&"list"!==a&&"BR"!==t.tagName||(r+="\n")}return r},V=0,z=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id="".concat(V++)},H=new WeakMap,J=new WeakMap,U=new WeakMap,q=new WeakMap,Y=new WeakMap,G=new WeakMap,X=new WeakMap,$=new WeakMap,Q=new WeakMap,Z=new WeakMap,ee=new WeakMap,te=Symbol("placeholder"),re=new Map,ne=new Map,oe=new Map,ae={findKey:function(e,t){var r=$.get(t);return r||(r=new z,$.set(t,r)),r},findPath:function(e,r){for(var n=[],o=r;;){var a=J.get(o);if(null==a){if(t.Editor.isEditor(o))return n;break}var i=H.get(o);if(null==i)break;n.unshift(i),o=a}throw new Error("Unable to find the path for Slate node: ".concat(JSON.stringify(r)))},isFocused:function(e){return!!Z.get(e)},isReadOnly:function(e){return!!Q.get(e)},blur:function(e){var t=ae.toDOMNode(e,e);Z.set(e,!1),window.document.activeElement===t&&t.blur()},focus:function(e){var t=ae.toDOMNode(e,e);Z.set(e,!0),window.document.activeElement!==t&&t.focus({preventScroll:!0})},deselect:function(e){var r=e.selection,n=window.getSelection();n&&n.rangeCount>0&&n.removeAllRanges(),r&&t.Transforms.deselect(e)},hasDOMNode:function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.editable,a=void 0!==o&&o,i=ae.toDOMNode(e,e);try{r=R(t)?t:t.parentElement}catch(e){if(!e.message.includes('Permission denied to access property "nodeType"'))throw e}return!!r&&(r.closest("[data-slate-editor]")===i&&(!a||r.isContentEditable||!!r.getAttribute("data-slate-zero-width")))},insertData:function(e,t){e.insertData(t)},setFragmentData:function(e,t){e.setFragmentData(t)},toDOMNode:function(e,r){var n=t.Editor.isEditor(r)?U.get(e):G.get(ae.findKey(e,r));if(!n)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(JSON.stringify(r)));return n},toDOMPoint:function(e,r){var n,o=g(t.Editor.node(e,r.path),1)[0],a=ae.toDOMNode(e,o);t.Editor.void(e,{at:r})&&(r={path:r.path,offset:0});for(var i=0,d=0,s=Array.from(a.querySelectorAll("[data-slate-string], [data-slate-zero-width]"));d<s.length;d++){var l=s[d],c=l.childNodes[0];if(null!=c&&null!=c.textContent){var f=c.textContent.length,u=l.getAttribute("data-slate-length"),p=i+(null==u?f:parseInt(u,10));if(r.offset<=p){n=[c,Math.min(f,Math.max(0,r.offset-i))];break}i=p}}if(!n)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(JSON.stringify(r)));return n},toDOMRange:function(e,r){var n=r.anchor,o=r.focus,a=t.Range.isBackward(r),i=ae.toDOMPoint(e,n),d=t.Range.isCollapsed(r)?i:ae.toDOMPoint(e,o),s=window.document.createRange(),l=g(a?d:i,2),c=l[0],f=l[1],u=g(a?i:d,2),p=u[0],v=u[1],h=!!(R(c)?c:c.parentElement).getAttribute("data-slate-zero-width"),w=!!(R(p)?p:p.parentElement).getAttribute("data-slate-zero-width");return s.setStart(c,h?1:f),s.setEnd(p,w?1:v),s},toSlateNode:function(e,t){var r=R(t)?t:t.parentElement;r&&!r.hasAttribute("data-slate-node")&&(r=r.closest("[data-slate-node]"));var n=r?Y.get(r):null;if(!n)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(r));return n},findEventRange:function(e,r){"nativeEvent"in r&&(r=r.nativeEvent);var n=r,o=n.clientX,a=n.clientY,i=n.target;if(null==o||null==a)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(r));var d,s=ae.toSlateNode(e,r.target),l=ae.findPath(e,s);if(t.Editor.isVoid(e,s)){var c=i.getBoundingClientRect(),f=e.isInline(s)?o-c.left<c.left+c.width-o:a-c.top<c.top+c.height-a,u=t.Editor.point(e,l,{edge:f?"start":"end"}),p=f?t.Editor.before(e,u):t.Editor.after(e,u);if(p)return t.Editor.range(e,p)}var v=window.document;if(v.caretRangeFromPoint)d=v.caretRangeFromPoint(o,a);else{var h=v.caretPositionFromPoint(o,a);h&&((d=v.createRange()).setStart(h.offsetNode,h.offset),d.setEnd(h.offsetNode,h.offset))}if(!d)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(r));return ae.toSlateRange(e,d)},toSlatePoint:function(e,t){var r=g(I(t),2),n=r[0],o=r[1],a=n.parentNode,i=null,d=0;if(a){var s=a.closest('[data-slate-void="true"]'),l=a.closest("[data-slate-leaf]"),c=null;if(l){i=l.closest('[data-slate-node="text"]');var f=window.document.createRange();f.setStart(i,0),f.setEnd(n,o);var u=f.cloneContents();[].concat(w(u.querySelectorAll("[data-slate-zero-width]")),w(u.querySelectorAll("[contenteditable=false]"))).forEach((function(e){e.parentNode.removeChild(e)})),d=u.textContent.length,c=i}else s&&(i=(l=s.querySelector("[data-slate-leaf]")).closest('[data-slate-node="text"]'),d=(c=l).textContent.length);c&&d===c.textContent.length&&a.hasAttribute("data-slate-zero-width")&&d--}if(!i)throw new Error("Cannot resolve a Slate point from DOM point: ".concat(t));var p=ae.toSlateNode(e,i);return{path:ae.findPath(e,p),offset:d}},toSlateRange:function(e,t){var r,n,o,a,i;if((t instanceof Selection?t.anchorNode:t.startContainer)&&(t instanceof Selection?(r=t.anchorNode,n=t.anchorOffset,o=t.focusNode,a=t.focusOffset,i=t.isCollapsed):(r=t.startContainer,n=t.startOffset,o=t.endContainer,a=t.endOffset,i=t.collapsed)),null==r||null==o||null==n||null==a)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(t));var d=ae.toSlatePoint(e,[r,n]);return{anchor:d,focus:i?d:ae.toSlatePoint(e,[o,a])}}},ie=function(e){return t.Editor.isEditor(e)?e._state:e.children},de=function(e){return JSON.parse(JSON.stringify(e))},se=function(e,r){if(t.Text.isText(e))throw new Error("Cannot get the child of a text node: ".concat(JSON.stringify(e)));var n=ie(e)[r];if(null==n)throw new Error("Cannot get child at index `".concat(r,"` in node: ").concat(JSON.stringify(e)));return n},le=function(e,r){for(var n=e,o=0;o<r.length;o++){var a=r[o],i=ie(n);if(t.Text.isText(n)||!i[a])return!1;n=i[a]}return!0},ce=function(e,r){for(var n=e,o=0;o<r.length;o++){var a=r[o],i=ie(n);if(t.Text.isText(n)||!i[a])throw new Error("Cannot find a descendant at path [".concat(r,"] in node: ").concat(JSON.stringify(e)));n=i[a]}return n},fe=function(e,r){for(var n=r.slice(),o=t.Node.get(e,n),a=ie(o);o&&!t.Text.isText(o)&&0!==a.length;)o=a[0],n.push(0);return[o,n]},ue=function(e,r){for(var n=r.slice(),o=t.Node.get(e,n),a=ie(o);o&&!t.Text.isText(o)&&0!==a.length;){var i=a.length-1;o=a[i],n.push(i)}return[o,n]},pe=function*(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.pass,o=r.reverse,a=void 0!==o&&o,i=r.from,d=void 0===i?[]:i,s=r.to,l=new Set,c=[],f=e;!s||!(a?t.Path.isBefore(c,s):t.Path.isAfter(c,s));)if(l.has(f)||(yield[f,c]),l.has(f)||t.Text.isText(f)||0===ie(f).length||null!=n&&!1!==n([f,c])){if(0===c.length)break;if(!a){var u=t.Path.next(c);if(t.Node.has(e,u)){c=u,f=t.Node.get(e,c);continue}}if(a&&0!==c[c.length-1]){var p=t.Path.previous(c);c=p,f=t.Node.get(e,c)}else c=t.Path.parent(c),f=t.Node.get(e,c),l.add(f)}else{l.add(f);var v=a?ie(f).length-1:0;t.Path.isAncestor(c,d)&&(v=d[c.length]),c=c.concat(v),f=t.Node.get(e,c)}};k=t.Transforms.select,t.Transforms.select=function(e,t){return t.__ob__&&(t=de(t)),k(e,t)},t.Transforms;var ve,he=function(){var e=t.Node.get,r=t.Node.nodes,n=t.Node.has,o=t.Node.first,a=t.Node.child,i=t.Node.last;return t.Node.child=se,t.Node.has=le,t.Node.get=ce,t.Node.first=fe,t.Node.last=ue,t.Node.nodes=pe,function(){t.Node.get=e,t.Node.nodes=r,t.Node.has=n,t.Node.first=o,t.Node.child=a,t.Node.last=i}};ae.toDOMRange=(ve=ae.toDOMRange,function(){var e=he(),t=ve.apply(void 0,arguments);return e(),t});var ge=function(e,t){return A(t)&&ae.hasDOMNode(e,t)},we=function(e,t){return!!t&&(t(e),e.defaultPrevented||e.cancelBubble)},me=function(e,t){return A(t)&&ae.hasDOMNode(e,t,{editable:!0})},Ee=function(e,r){var n=ge(e,r)&&ae.toSlateNode(e,r);return t.Editor.isVoid(e,n)},ye=!(o||i),xe={onClick:function(e,r,n){if(!n.readOnly&&ge(r,e.target)&&A(e.target)&&!we(e,n.onClick)){var o=ae.toSlateNode(r,e.target),a=ae.findPath(r,o),i=t.Editor.start(r,a);if(t.Editor.void(r,{at:i})){var d=t.Editor.range(r,i);t.Transforms.select(r,d)}}},onBeforeInput:function(e,r,n){if(o){e.preventDefault(),e.stopPropagation();var a=e.detail;t.Editor.insertText(r,a)}else if(!n.readOnly&&me(r,e.target)&&!we(e,n.onBeforeInput)){var i=r.selection,d=e.inputType,s=e.dataTransfer||e.data||void 0;if("insertCompositionText"===d||"deleteCompositionText"===d)return;if(e.preventDefault(),!d.startsWith("delete")||d.startsWith("deleteBy")){var l=g(e.getTargetRanges(),1)[0];if(l){var c=ae.toSlateRange(r,l);i&&t.Range.equals(i,c)||t.Transforms.select(r,c)}}if(i&&t.Range.isExpanded(i)&&d.startsWith("delete"))return void t.Editor.deleteFragment(r);switch(d){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":t.Editor.deleteFragment(r);break;case"deleteContent":case"deleteContentForward":t.Editor.deleteForward(r);break;case"deleteContentBackward":t.Editor.deleteBackward(r);break;case"deleteEntireSoftLine":t.Editor.deleteBackward(r,{unit:"line"}),t.Editor.deleteForward(r,{unit:"line"});break;case"deleteHardLineBackward":t.Editor.deleteBackward(r,{unit:"block"});break;case"deleteSoftLineBackward":t.Editor.deleteBackward(r,{unit:"line"});break;case"deleteHardLineForward":t.Editor.deleteForward(r,{unit:"block"});break;case"deleteSoftLineForward":t.Editor.deleteForward(r,{unit:"line"});break;case"deleteWordBackward":t.Editor.deleteBackward(r,{unit:"word"});break;case"deleteWordForward":t.Editor.deleteForward(r,{unit:"word"});break;case"insertLineBreak":case"insertParagraph":t.Editor.insertBreak(r);break;case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":s instanceof DataTransfer?ae.insertData(r,s):"string"==typeof s&&t.Editor.insertText(r,s)}}},onCompositionEnd:function(e,r,n){me(r,e.target)&&!we(e,n.onCompositionEnd)&&(n.isComposing=!1,a||o||!e.data||t.Editor.insertText(r,e.data))},onCompositionStart:function(e,t,r){me(t,e.target)&&!we(e,r.onCompositionStart)&&(r.isComposing=!0)},onKeyDown:function(e,r,n){if(!n.readOnly&&me(r,e.target)&&!we(e,n.onKeyDown)){var o=e,a=r.selection;if(f.isRedo(o))return e.preventDefault(),void(r.redo&&r.redo());if(f.isUndo(o))return e.preventDefault(),void(r.undo&&r.undo());if(f.isMoveLineBackward(o))return e.preventDefault(),void t.Transforms.move(r,{unit:"line",reverse:!0});if(f.isMoveLineForward(o))return e.preventDefault(),void t.Transforms.move(r,{unit:"line"});if(f.isExtendLineBackward(o))return e.preventDefault(),void t.Transforms.move(r,{unit:"line",edge:"focus",reverse:!0});if(f.isExtendLineForward(o))return e.preventDefault(),void t.Transforms.move(r,{unit:"line",edge:"focus"});if(f.isMoveBackward(o))return e.preventDefault(),void(a&&t.Range.isCollapsed(a)?t.Transforms.move(r,{reverse:!0}):t.Transforms.collapse(r,{edge:"start"}));if(f.isMoveForward(o))return e.preventDefault(),void(a&&t.Range.isCollapsed(a)?t.Transforms.move(r):t.Transforms.collapse(r,{edge:"end"}));if(f.isMoveWordBackward(o))return e.preventDefault(),void t.Transforms.move(r,{unit:"word",reverse:!0});if(f.isMoveWordForward(o))return e.preventDefault(),void t.Transforms.move(r,{unit:"word"});if(!ye){if(f.isBold(o)||f.isItalic(o)||f.isTransposeCharacter(o))return void e.preventDefault();if(f.isSplitBlock(o))return e.preventDefault(),void t.Editor.insertBreak(r);if(f.isDeleteBackward(o))return e.preventDefault(),void(a&&t.Range.isExpanded(a)?t.Editor.deleteFragment(r):t.Editor.deleteBackward(r));if(f.isDeleteForward(o))return e.preventDefault(),void(a&&t.Range.isExpanded(a)?t.Editor.deleteFragment(r):t.Editor.deleteForward(r));if(f.isDeleteLineBackward(o))return e.preventDefault(),void(a&&t.Range.isExpanded(a)?t.Editor.deleteFragment(r):t.Editor.deleteBackward(r,{unit:"line"}));if(f.isDeleteLineForward(o))return e.preventDefault(),void(a&&t.Range.isExpanded(a)?t.Editor.deleteFragment(r):t.Editor.deleteForward(r,{unit:"line"}));if(f.isDeleteWordBackward(o))return e.preventDefault(),void(a&&t.Range.isExpanded(a)?t.Editor.deleteFragment(r):t.Editor.deleteBackward(r,{unit:"word"}));if(f.isDeleteWordForward(o))return e.preventDefault(),void(a&&t.Range.isExpanded(a)?t.Editor.deleteFragment(r):t.Editor.deleteForward(r,{unit:"word"}))}}},onFocus:function(e,t,r){if(!r.readOnly&&!r.isUpdatingSelection&&me(t,e.target)&&!we(e,r.onFocus)){var n=ae.toDOMNode(t,t);if(r.latestElement=window.document.activeElement,o&&e.target!==n)return void n.focus();Z.set(t,!0)}},onBlur:function(e,r,n){if(!n.readOnly&&!n.isUpdatingSelection&&me(r,e.target)&&we(e,n.onBlur)&&n.latestElement!==window.document.activeElement){var o=e.relatedTarget;if(!(o===ae.toDOMNode(r,r)||R(o)&&o.hasAttribute("data-slate-spacer"))){if(null!=o&&A(o)&&ae.hasDOMNode(r,o)){var a=ae.toSlateNode(r,o);if(t.Element.isElement(a)&&!r.isVoid(a))return}Z.delete(r)}}},onCopy:function(e,t,r){me(t,e.target)&&!we(e,r.onCopy)&&(e.preventDefault(),ae.setFragmentData(t,e.clipboardData))},onPaste:function(e,t,r){ye&&!W(e)||r.readOnly||!me(t,e.target)||we(e,r.onPaste)||(e.preventDefault(),ae.insertData(t,e.clipboardData))},onCut:function(e,r,n){if(!n.readOnly&&me(r,e.target)&&!we(e,n.onCut)){e.preventDefault(),ae.setFragmentData(r,e.clipboardData);var o=r.selection;o&&t.Range.isExpanded(o)&&t.Editor.deleteFragment(r)}},onDragOver:function(e,r,n){if(ge(r,e.target)&&!we(e,n.onDragOver)){var o=ae.toSlateNode(r,e.target);t.Editor.isVoid(r,o)&&e.preventDefault()}},onDragStart:function(e,r,n){if(ge(r,e.target)&&!we(e,n.onDragStart)){var o=ae.toSlateNode(r,e.target),a=ae.findPath(r,o);if(t.Editor.void(r,{at:a})){var i=t.Editor.range(r,a);t.Transforms.select(r,i)}ae.setFragmentData(r,e.clipboardData)}},onDrop:function(e,r,n){if(ge(r,e.target)&&!n.readOnly&&!we(e,n.onDrop)&&(!ye||!a&&e.dataTransfer.files.length>0)){e.preventDefault();var o=ae.findEventRange(r,e),i=e.dataTransfer;t.Transforms.select(r,o),ae.insertData(r,i)}},onSelectionchange:function(e,r){if(!r.readOnly&&!r.isComposing&&!r.isUpdatingSelection){var n=window.document.activeElement,o=ae.toDOMNode(e,e),a=window.getSelection();if(n===o?(r.latestElement=n,Z.set(e,!0)):Z.delete(e),!a)return t.Transforms.deselect(e);var i=a.anchorNode,d=a.focusNode,s=me(e,i)||Ee(e,i),l=me(e,d)||Ee(e,d);if(s&&l){var c=ae.toSlateRange(e,a);t.Transforms.select(e,c)}else t.Transforms.deselect(e)}}};exports.DOMComment=T,exports.DOMElement=C,exports.DOMNode=S,exports.DOMRange=F,exports.DOMSelection=B,exports.DOMStaticRange=_,exports.DOMText=M,exports.EDITOR_TO_ELEMENT=U,exports.EDITOR_TO_GVM=ne,exports.EDITOR_TO_ON_CHANGE=ee,exports.EDITOR_TO_PLACEHOLDER=q,exports.ELEMENT_TO_NODE=Y,exports.EditableComponent=xe,exports.GVM_TO_EDITOR=oe,exports.Hotkeys=f,exports.IS_APPLE=n,exports.IS_EDGE_LEGACY=i,exports.IS_FIREFOX=o,exports.IS_FOCUSED=Z,exports.IS_IOS=r,exports.IS_READ_ONLY=Q,exports.IS_SAFARI=a,exports.KEY_TO_ELEMENT=G,exports.KEY_TO_VNODE=re,exports.Key=z,exports.NODE_TO_ELEMENT=X,exports.NODE_TO_INDEX=H,exports.NODE_TO_KEY=$,exports.NODE_TO_PARENT=J,exports.PLACEHOLDER_SYMBOL=te,exports.VueEditor=ae,exports.addOnBeforeInput=function(e,t){["compositionend","textInput","keypress"].forEach((function(r){e.addEventListener(r,(function(e){N(r,e),"compositionend"===r&&(D=!1),t&&e.preventDefault()}))})),e.addEventListener("compositionstart",(function(){return D=!0}))},exports.getEditableChild=j,exports.getPlainText=K,exports.isDOMComment=P,exports.isDOMElement=R,exports.isDOMNode=A,exports.isDOMText=L,exports.isPlainTextOnlyPaste=W,exports.normalizeDOMPoint=I,exports.withVue=function(e){var r=e,n=r.apply,o=r.onChange;return r.apply=function(o){var a=[];switch(r._operation=o,o.type){case"insert_text":case"remove_text":case"set_node":var i,d=y(t.Editor.levels(r,{at:o.path}));try{for(d.s();!(i=d.n()).done;){var s=g(i.value,2),l=s[0],c=s[1],f=ae.findKey(r,l);a.push([c,f])}}catch(e){d.e(e)}finally{d.f()}break;case"insert_node":case"remove_node":case"merge_node":case"split_node":var u,p=y(t.Editor.levels(r,{at:t.Path.parent(o.path)}));try{for(p.s();!(u=p.n()).done;){var v=g(u.value,2),m=v[0],E=v[1],x=ae.findKey(r,m);a.push([E,x])}}catch(e){p.e(e)}finally{p.f()}}n(o);for(var b=0,D=a;b<D.length;b++){var O=g(D[b],2),k=O[0],N=O[1],S=g(t.Editor.node(r,k),1)[0];$.set(S,N)}!function(e){for(var t=he(),r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=e.apply(void 0,n);t()}((function(){!function(e,r,n){switch(r.type){case"insert_node":var o=r.path,a=r.node,i=t.Node.parent(e,o),d=o[o.length-1];ie(i).splice(d,0,de(a));break;case"insert_text":var s=r.path,l=r.offset,c=r.text,f=t.Node.leaf(e,s),u=f.text.slice(0,l),p=f.text.slice(l);f.text=u+c+p;break;case"merge_node":var v=r.path,g=t.Node.get(e,v),m=t.Path.previous(v),E=t.Node.get(e,m),y=t.Node.parent(e,v),x=v[v.length-1];if(t.Text.isText(g)&&t.Text.isText(E))E.text+=g.text;else{if(t.Text.isText(g)||t.Text.isText(E))throw new Error('Cannot apply a "merge_node" operation at path ['.concat(v,"] to nodes of different interaces: ").concat(g," ").concat(E));var b;(b=ie(E)).push.apply(b,w(ie(g)))}ie(y).splice(x,1);break;case"move_node":var D=r.path,O=r.newPath;if(t.Path.isAncestor(D,O))throw new Error("Cannot move a path [".concat(D,"] to new path [").concat(O,"] because the destination is inside itself."));var k=t.Node.get(e,D),N=t.Node.parent(e,D),S=D[D.length-1];ie(N).splice(S,1);var T=t.Path.transform(D,r),C=t.Node.get(e,t.Path.parent(T)),M=T[T.length-1];ie(C).splice(M,0,k);break;case"remove_node":var F=r.path;$.delete(t.Node.get(e,F));var B=F[F.length-1],_=t.Node.parent(e,F);ie(_).splice(B,1);break;case"remove_text":var P=r.path,R=r.offset,A=r.text,L=t.Node.leaf(e,P),W=L.text.slice(0,R),I=L.text.slice(R+A.length);L.text=W+I;break;case"set_node":var j=r.path,K=r.newProperties;if(0===j.length)throw new Error("Cannot set properties on the root node!");var V=t.Node.get(e,j);for(var z in K){if("children"===z||"text"===z)throw new Error('Cannot set the "'.concat(z,'" property of nodes!'));var H=K[z];n&&(null==H?n.delete(V,z):n.set(V,z,H))}break;case"set_selection":break;case"split_node":var J=r.path,U=r.position,q=r.properties;if(0===J.length)throw new Error('Cannot apply a "split_node" operation at path ['.concat(J,"] because the root node cannot be split."));var Y,G=t.Node.get(e,J),X=t.Node.parent(e,J),Q=J[J.length-1];if(t.Text.isText(G)){var Z=G.text.slice(0,U),ee=G.text.slice(U);G.text=Z,Y=h(h(h({},G),q),{},{text:ee})}else{var te=G.children.slice(0,U),re=G.children.slice(U);G.children=te,Y=h(h(h({},G),q),{},{children:re})}ie(X).splice(Q+1,0,Y)}}(e,o)}))},r.setFragmentData=function(e){var n=r.selection;if(n){var o=g(t.Range.edges(n),2),a=o[0],i=o[1],d=t.Editor.void(r,{at:a.path}),s=t.Editor.void(r,{at:i.path});if(!t.Range.isCollapsed(n)||d){var l=ae.toDOMRange(r,n),c=l.cloneContents(),f=c.childNodes[0];if(c.childNodes.forEach((function(e){e.textContent&&""!==e.textContent.trim()&&(f=e)})),s){var u=g(s,1)[0],p=l.cloneRange(),v=ae.toDOMNode(r,u);p.setEndAfter(v),c=p.cloneContents()}if(d&&(f=c.querySelector("[data-slate-spacer]")),Array.from(c.querySelectorAll("[data-slate-zero-width]")).forEach((function(e){var t="n"===e.getAttribute("data-slate-zero-width");e.textContent=t?"\n":""})),L(f)){var h=document.createElement("span");h.style.whiteSpace="pre",h.appendChild(f),c.appendChild(h),f=h}var w=r.getFragment(),m=JSON.stringify(w),E=window.btoa(encodeURIComponent(m));f.setAttribute("data-slate-fragment",E),e.setData("application/x-slate-fragment",E);var y=document.createElement("div");y.appendChild(c),y.setAttribute("hidden","true"),document.body.appendChild(y),e.setData("text/html",y.innerHTML),e.setData("text/plain",K(y)),document.body.removeChild(y)}}},r.insertData=function(e){var n=e.getData("application/x-slate-fragment");if(n){var o=decodeURIComponent(window.atob(n)),a=JSON.parse(o);r.insertFragment(a)}else{var i=e.getData("text/plain");if(i){var d,s=!1,l=y(i.split(/\r\n|\r|\n/));try{for(l.s();!(d=l.n()).done;){var c=d.value;s&&t.Transforms.splitNodes(r,{always:!0}),t.Transforms.insertText(r,c),s=!0}}catch(e){l.e(e)}finally{l.f()}}}},r.onChange=function(){var e=ee.get(r);e&&e(),o()},r};
//# sourceMappingURL=index.cjs.js.map
