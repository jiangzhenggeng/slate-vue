import{isKeyHotkey as e}from"is-hotkey";import{Editor as t,Transforms as n,Range as r,Node as a,Text as o,Path as i,Element as d}from"slate";var l="undefined"!=typeof navigator&&"undefined"!=typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,s="undefined"!=typeof navigator&&/Mac OS X/.test(navigator.userAgent),c="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),u="undefined"!=typeof navigator&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])/i.test(navigator.userAgent),p={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",splitBlock:"shift?+enter",undo:"mod+z"},v={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},h={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},g=function(t){var n=p[t],r=v[t],a=h[t],o=n&&e(n),i=r&&e(r),d=a&&e(a);return function(e){return!(!o||!o(e))||(!!(s&&i&&i(e))||!(s||!d||!d(e)))}},w={isBold:g("bold"),isCompose:g("compose"),isMoveBackward:g("moveBackward"),isMoveForward:g("moveForward"),isDeleteBackward:g("deleteBackward"),isDeleteForward:g("deleteForward"),isDeleteLineBackward:g("deleteLineBackward"),isDeleteLineForward:g("deleteLineForward"),isDeleteWordBackward:g("deleteWordBackward"),isDeleteWordForward:g("deleteWordForward"),isExtendBackward:g("extendBackward"),isExtendForward:g("extendForward"),isExtendLineBackward:g("extendLineBackward"),isExtendLineForward:g("extendLineForward"),isItalic:g("italic"),isMoveLineBackward:g("moveLineBackward"),isMoveLineForward:g("moveLineForward"),isMoveWordBackward:g("moveWordBackward"),isMoveWordForward:g("moveWordForward"),isRedo:g("redo"),isSplitBlock:g("splitBlock"),isTransposeCharacter:g("transposeCharacter"),isUndo:g("undo")};function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,d=e[Symbol.iterator]();!(r=(i=d.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==d.return||d.return()}finally{if(a)throw o}}return n}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,d=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){d=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(d)throw o}}}}var O="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,F=String.fromCharCode(32),B=!1;var M=function(e,t){var n=!1;switch(e){case"compositionend":return function(e){var t=e.detail;return"object"===m(t)&&"data"in t?t.data:null}(t);case"keypress":return 32!==t.which?null:(n=!0,F);case"textInput":var r=t.data;return r===F&&n?null:r;default:return null}};var N,T=function(e,t){var n;n=O&&"TextEvent"in window?M(e,t):function(e,t){if(B)return"compositionend"===e?t.data:null;switch(e){case"paste":return null;case"keypress":if(!function(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}(t)){if(t.char&&t.char.length>1)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return t.data;default:return null}}(e,t);var r=new CustomEvent("beforeinput",{detail:n});t.target&&t.target.dispatchEvent(r)},A=function(e,t){["compositionend","textInput","keypress"].forEach((function(n){e.addEventListener(n,(function(e){T(n,e),"compositionend"===n&&(B=!1),t&&e.preventDefault()}))})),e.addEventListener("compositionstart",(function(){return B=!0}))},P=globalThis.Node,W=globalThis.Comment,L=globalThis.Element,R=globalThis.Text,_=globalThis.Range,j=globalThis.Selection,I=globalThis.StaticRange,z=function(e){return J(e)&&8===e.nodeType},K=function(e){return J(e)&&1===e.nodeType},J=function(e){return e instanceof Node},U=function(e){return J(e)&&3===e.nodeType},V=function(e){return e.clipboardData&&""!==e.clipboardData.getData("text/plain")&&1===e.clipboardData.types.length},q=function(e){var t=D(e,2),n=t[0],r=t[1];if(K(n)&&n.childNodes.length){var a=r===n.childNodes.length,o=a?"backward":"forward";for(n=H(n,a?r-1:r,o);K(n)&&n.childNodes.length;){var i=a?n.childNodes.length-1:0;n=H(n,i,o)}r=a&&null!=n.textContent?n.textContent.length:0}return[n,r]},H=function(e,t,n){for(var r=e.childNodes,a=r[t],o=t,i=!1,d=!1;(z(a)||K(a)&&0===a.childNodes.length||K(a)&&"false"===a.getAttribute("contenteditable"))&&(!i||!d);)o>=r.length?(i=!0,o=t-1,n="backward"):o<0?(d=!0,o=t+1,n="forward"):(a=r[o],o+="forward"===n?1:-1);return a},X=function e(t){var n="";if(U(t)&&t.nodeValue)return t.nodeValue;if(K(t)){for(var r=0,a=Array.from(t.childNodes);r<a.length;r++){n+=e(a[r])}var o=getComputedStyle(t).getPropertyValue("display");"block"!==o&&"list"!==o&&"BR"!==t.tagName||(n+="\n")}return n},Y=0,$=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id="".concat(Y++)},G=new WeakMap,Q=new WeakMap,Z=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakMap,ae=new WeakMap,oe=new WeakMap,ie=new WeakMap,de=new WeakMap,le=Symbol("placeholder"),se=new Map,ce=new Map,fe=new Map,ue={findKey:function(e,t){var n=ae.get(t);return n||(n=new $,ae.set(t,n)),n},findPath:function(e,n){for(var r=[],a=n;;){var o=Q.get(a);if(null==o){if(t.isEditor(a))return r;break}var i=G.get(a);if(null==i)break;r.unshift(i),a=o}throw new Error("Unable to find the path for Slate node: ".concat(JSON.stringify(n)))},isFocused:function(e){return!!ie.get(e)},isReadOnly:function(e){return!!oe.get(e)},blur:function(e){var t=ue.toDOMNode(e,e);ie.set(e,!1),window.document.activeElement===t&&t.blur()},focus:function(e){var t=ue.toDOMNode(e,e);ie.set(e,!0),window.document.activeElement!==t&&t.focus({preventScroll:!0})},deselect:function(e){var t=e.selection,r=window.getSelection();r&&r.rangeCount>0&&r.removeAllRanges(),t&&n.deselect(e)},hasDOMNode:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.editable,o=void 0!==a&&a,i=ue.toDOMNode(e,e);try{n=K(t)?t:t.parentElement}catch(e){if(!e.message.includes('Permission denied to access property "nodeType"'))throw e}return!!n&&(n.closest("[data-slate-editor]")===i&&(!o||n.isContentEditable||!!n.getAttribute("data-slate-zero-width")))},insertData:function(e,t){e.insertData(t)},setFragmentData:function(e,t){e.setFragmentData(t)},toDOMNode:function(e,n){var r=t.isEditor(n)?Z.get(e):ne.get(ue.findKey(e,n));if(!r)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(JSON.stringify(n)));return r},toDOMPoint:function(e,n){var r,a=D(t.node(e,n.path),1)[0],o=ue.toDOMNode(e,a);t.void(e,{at:n})&&(n={path:n.path,offset:0});for(var i=0,d=0,l=Array.from(o.querySelectorAll("[data-slate-string], [data-slate-zero-width]"));d<l.length;d++){var s=l[d],c=s.childNodes[0];if(null!=c&&null!=c.textContent){var f=c.textContent.length,u=s.getAttribute("data-slate-length"),p=i+(null==u?f:parseInt(u,10));if(n.offset<=p){r=[c,Math.min(f,Math.max(0,n.offset-i))];break}i=p}}if(!r)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(JSON.stringify(n)));return r},toDOMRange:function(e,t){var n=t.anchor,a=t.focus,o=r.isBackward(t),i=ue.toDOMPoint(e,n),d=r.isCollapsed(t)?i:ue.toDOMPoint(e,a),l=window.document.createRange(),s=D(o?d:i,2),c=s[0],f=s[1],u=D(o?i:d,2),p=u[0],v=u[1],h=!!(K(c)?c:c.parentElement).getAttribute("data-slate-zero-width"),g=!!(K(p)?p:p.parentElement).getAttribute("data-slate-zero-width");return l.setStart(c,h?1:f),l.setEnd(p,g?1:v),l},toSlateNode:function(e,t){var n=K(t)?t:t.parentElement;n&&!n.hasAttribute("data-slate-node")&&(n=n.closest("[data-slate-node]"));var r=n?te.get(n):null;if(!r)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(n));return r},findEventRange:function(e,n){"nativeEvent"in n&&(n=n.nativeEvent);var r=n,a=r.clientX,o=r.clientY,i=r.target;if(null==a||null==o)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(n));var d,l=ue.toSlateNode(e,n.target),s=ue.findPath(e,l);if(t.isVoid(e,l)){var c=i.getBoundingClientRect(),f=e.isInline(l)?a-c.left<c.left+c.width-a:o-c.top<c.top+c.height-o,u=t.point(e,s,{edge:f?"start":"end"}),p=f?t.before(e,u):t.after(e,u);if(p)return t.range(e,p)}var v=window.document;if(v.caretRangeFromPoint)d=v.caretRangeFromPoint(a,o);else{var h=v.caretPositionFromPoint(a,o);h&&((d=v.createRange()).setStart(h.offsetNode,h.offset),d.setEnd(h.offsetNode,h.offset))}if(!d)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(n));return ue.toSlateRange(e,d)},toSlatePoint:function(e,t){var n=D(q(t),2),r=n[0],a=n[1],o=r.parentNode,i=null,d=0;if(o){var l=o.closest('[data-slate-void="true"]'),s=o.closest("[data-slate-leaf]"),c=null;if(s){i=s.closest('[data-slate-node="text"]');var f=window.document.createRange();f.setStart(i,0),f.setEnd(r,a);var u=f.cloneContents();[].concat(S(u.querySelectorAll("[data-slate-zero-width]")),S(u.querySelectorAll("[contenteditable=false]"))).forEach((function(e){e.parentNode.removeChild(e)})),d=u.textContent.length,c=i}else l&&(i=(s=l.querySelector("[data-slate-leaf]")).closest('[data-slate-node="text"]'),d=(c=s).textContent.length);c&&d===c.textContent.length&&o.hasAttribute("data-slate-zero-width")&&d--}if(!i)throw new Error("Cannot resolve a Slate point from DOM point: ".concat(t));var p=ue.toSlateNode(e,i);return{path:ue.findPath(e,p),offset:d}},toSlateRange:function(e,t){var n,r,a,o,i;if((t instanceof Selection?t.anchorNode:t.startContainer)&&(t instanceof Selection?(n=t.anchorNode,r=t.anchorOffset,a=t.focusNode,o=t.focusOffset,i=t.isCollapsed):(n=t.startContainer,r=t.startOffset,a=t.endContainer,o=t.endOffset,i=t.collapsed)),null==n||null==a||null==r||null==o)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(t));var d=ue.toSlatePoint(e,[n,r]);return{anchor:d,focus:i?d:ue.toSlatePoint(e,[a,o])}}},pe=function(e){return t.isEditor(e)?e._state:e.children},ve=function(e){return JSON.parse(JSON.stringify(e))},he=function(e,t){if(o.isText(e))throw new Error("Cannot get the child of a text node: ".concat(JSON.stringify(e)));var n=pe(e)[t];if(null==n)throw new Error("Cannot get child at index `".concat(t,"` in node: ").concat(JSON.stringify(e)));return n},ge=function(e,t){for(var n=e,r=0;r<t.length;r++){var a=t[r],i=pe(n);if(o.isText(n)||!i[a])return!1;n=i[a]}return!0},we=function(e,t){for(var n=e,r=0;r<t.length;r++){var a=t[r],i=pe(n);if(o.isText(n)||!i[a])throw new Error("Cannot find a descendant at path [".concat(t,"] in node: ").concat(JSON.stringify(e)));n=i[a]}return n},me=function(e,t){for(var n=t.slice(),r=a.get(e,n),i=pe(r);r&&!o.isText(r)&&0!==i.length;)r=i[0],n.push(0);return[r,n]},ye=function(e,t){for(var n=t.slice(),r=a.get(e,n),i=pe(r);r&&!o.isText(r)&&0!==i.length;){var d=i.length-1;r=i[d],n.push(d)}return[r,n]},be=function*(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.pass,r=t.reverse,d=void 0!==r&&r,l=t.from,s=void 0===l?[]:l,c=t.to,f=new Set,u=[],p=e;!c||!(d?i.isBefore(u,c):i.isAfter(u,c));)if(f.has(p)||(yield[p,u]),f.has(p)||o.isText(p)||0===pe(p).length||null!=n&&!1!==n([p,u])){if(0===u.length)break;if(!d){var v=i.next(u);if(a.has(e,v)){u=v,p=a.get(e,u);continue}}if(d&&0!==u[u.length-1]){var h=i.previous(u);u=h,p=a.get(e,u)}else u=i.parent(u),p=a.get(e,u),f.add(p)}else{f.add(p);var g=d?pe(p).length-1:0;i.isAncestor(u,s)&&(g=s[u.length]),u=u.concat(g),p=a.get(e,u)}};N=n.select,n.select=function(e,t){return t.__ob__&&(t=ve(t)),N(e,t)};var ke,De=function(){var e=a.get,t=a.nodes,n=a.has,r=a.first,o=a.child,i=a.last;return a.child=he,a.has=ge,a.get=we,a.first=me,a.last=ye,a.nodes=be,function(){a.get=e,a.nodes=t,a.has=n,a.first=r,a.child=o,a.last=i}};ue.toDOMRange=(ke=ue.toDOMRange,function(){var e=De(),t=ke.apply(void 0,arguments);return e(),t});var Se=function(e){var d=e,l=d.apply,s=d.onChange;return d.apply=function(n){var r=[];switch(d._operation=n,n.type){case"insert_text":case"remove_text":case"set_node":var s,c=E(t.levels(d,{at:n.path}));try{for(c.s();!(s=c.n()).done;){var f=D(s.value,2),u=f[0],p=f[1],v=ue.findKey(d,u);r.push([p,v])}}catch(e){c.e(e)}finally{c.f()}break;case"insert_node":case"remove_node":case"merge_node":case"split_node":var h,g=E(t.levels(d,{at:i.parent(n.path)}));try{for(g.s();!(h=g.n()).done;){var w=D(h.value,2),m=w[0],y=w[1],b=ue.findKey(d,m);r.push([y,b])}}catch(e){g.e(e)}finally{g.f()}}l(n);for(var x=0,C=r;x<C.length;x++){var O=D(C[x],2),F=O[0],B=O[1],M=D(t.node(d,F),1)[0];ae.set(M,B)}!function(e){for(var t=De(),n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var o=e.apply(void 0,r);t()}((function(){!function(e,t,n){switch(t.type){case"insert_node":var r=t.path,d=t.node,l=a.parent(e,r),s=r[r.length-1];pe(l).splice(s,0,ve(d));break;case"insert_text":var c=t.path,f=t.offset,u=t.text,p=a.leaf(e,c),v=p.text.slice(0,f),h=p.text.slice(f);p.text=v+u+h;break;case"merge_node":var g=t.path,w=a.get(e,g),m=i.previous(g),y=a.get(e,m),b=a.parent(e,g),D=g[g.length-1];if(o.isText(w)&&o.isText(y))y.text+=w.text;else{if(o.isText(w)||o.isText(y))throw new Error('Cannot apply a "merge_node" operation at path ['.concat(g,"] to nodes of different interaces: ").concat(w," ").concat(y));var x;(x=pe(y)).push.apply(x,S(pe(w)))}pe(b).splice(D,1);break;case"move_node":var C=t.path,E=t.newPath;if(i.isAncestor(C,E))throw new Error("Cannot move a path [".concat(C,"] to new path [").concat(E,"] because the destination is inside itself."));var O=a.get(e,C),F=a.parent(e,C),B=C[C.length-1];pe(F).splice(B,1);var M=i.transform(C,t),N=a.get(e,i.parent(M)),T=M[M.length-1];pe(N).splice(T,0,O);break;case"remove_node":var A=t.path;ae.delete(a.get(e,A));var P=A[A.length-1],W=a.parent(e,A);pe(W).splice(P,1);break;case"remove_text":var L=t.path,R=t.offset,_=t.text,j=a.leaf(e,L),I=j.text.slice(0,R),z=j.text.slice(R+_.length);j.text=I+z;break;case"set_node":var K=t.path,J=t.newProperties;if(0===K.length)throw new Error("Cannot set properties on the root node!");var U=a.get(e,K);for(var V in J){if("children"===V||"text"===V)throw new Error('Cannot set the "'.concat(V,'" property of nodes!'));var q=J[V];n&&(null==q?n.delete(U,V):n.set(U,V,q))}break;case"set_selection":break;case"split_node":var H=t.path,X=t.position,Y=t.properties;if(0===H.length)throw new Error('Cannot apply a "split_node" operation at path ['.concat(H,"] because the root node cannot be split."));var $,G=a.get(e,H),Q=a.parent(e,H),Z=H[H.length-1];if(o.isText(G)){var ee=G.text.slice(0,X),te=G.text.slice(X);G.text=ee,$=k(k(k({},G),Y),{},{text:te})}else{var ne=G.children.slice(0,X),re=G.children.slice(X);G.children=ne,$=k(k(k({},G),Y),{},{children:re})}pe(Q).splice(Z+1,0,$)}}(e,n)}))},d.setFragmentData=function(e){var n=d.selection;if(n){var a=D(r.edges(n),2),o=a[0],i=a[1],l=t.void(d,{at:o.path}),s=t.void(d,{at:i.path});if(!r.isCollapsed(n)||l){var c=ue.toDOMRange(d,n),f=c.cloneContents(),u=f.childNodes[0];if(f.childNodes.forEach((function(e){e.textContent&&""!==e.textContent.trim()&&(u=e)})),s){var p=D(s,1)[0],v=c.cloneRange(),h=ue.toDOMNode(d,p);v.setEndAfter(h),f=v.cloneContents()}if(l&&(u=f.querySelector("[data-slate-spacer]")),Array.from(f.querySelectorAll("[data-slate-zero-width]")).forEach((function(e){var t="n"===e.getAttribute("data-slate-zero-width");e.textContent=t?"\n":""})),U(u)){var g=document.createElement("span");g.style.whiteSpace="pre",g.appendChild(u),f.appendChild(g),u=g}var w=d.getFragment(),m=JSON.stringify(w),y=window.btoa(encodeURIComponent(m));u.setAttribute("data-slate-fragment",y),e.setData("application/x-slate-fragment",y);var b=document.createElement("div");b.appendChild(f),b.setAttribute("hidden","true"),document.body.appendChild(b),e.setData("text/html",b.innerHTML),e.setData("text/plain",X(b)),document.body.removeChild(b)}}},d.insertData=function(e){var t=e.getData("application/x-slate-fragment");if(t){var r=decodeURIComponent(window.atob(t)),a=JSON.parse(r);d.insertFragment(a)}else{var o=e.getData("text/plain");if(o){var i,l=!1,s=E(o.split(/\r\n|\r|\n/));try{for(s.s();!(i=s.n()).done;){var c=i.value;l&&n.splitNodes(d,{always:!0}),n.insertText(d,c),l=!0}}catch(e){s.e(e)}finally{s.f()}}}},d.onChange=function(){var e=de.get(d);e&&e(),s()},d},xe=function(e,t){return J(t)&&ue.hasDOMNode(e,t)},Ce=function(e,t){return!!t&&(t(e),e.defaultPrevented||e.cancelBubble)},Ee=function(e,t){return J(t)&&ue.hasDOMNode(e,t,{editable:!0})},Oe=function(e,n){var r=xe(e,n)&&ue.toSlateNode(e,n);return t.isVoid(e,r)},Fe=!(c||u),Be={onClick:function(e,r,a){if(!a.readOnly&&xe(r,e.target)&&J(e.target)&&!Ce(e,a.onClick)){var o=ue.toSlateNode(r,e.target),i=ue.findPath(r,o),d=t.start(r,i);if(t.void(r,{at:d})){var l=t.range(r,d);n.select(r,l)}}},onBeforeInput:function(e,a,o){if(c){e.preventDefault(),e.stopPropagation();var i=e.detail;t.insertText(a,i)}else if(!o.readOnly&&Ee(a,e.target)&&!Ce(e,o.onBeforeInput)){var d=a.selection,l=e.inputType,s=e.dataTransfer||e.data||void 0;if("insertCompositionText"===l||"deleteCompositionText"===l)return;if(e.preventDefault(),!l.startsWith("delete")||l.startsWith("deleteBy")){var f=D(e.getTargetRanges(),1)[0];if(f){var u=ue.toSlateRange(a,f);d&&r.equals(d,u)||n.select(a,u)}}if(d&&r.isExpanded(d)&&l.startsWith("delete"))return void t.deleteFragment(a);switch(l){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":t.deleteFragment(a);break;case"deleteContent":case"deleteContentForward":t.deleteForward(a);break;case"deleteContentBackward":t.deleteBackward(a);break;case"deleteEntireSoftLine":t.deleteBackward(a,{unit:"line"}),t.deleteForward(a,{unit:"line"});break;case"deleteHardLineBackward":t.deleteBackward(a,{unit:"block"});break;case"deleteSoftLineBackward":t.deleteBackward(a,{unit:"line"});break;case"deleteHardLineForward":t.deleteForward(a,{unit:"block"});break;case"deleteSoftLineForward":t.deleteForward(a,{unit:"line"});break;case"deleteWordBackward":t.deleteBackward(a,{unit:"word"});break;case"deleteWordForward":t.deleteForward(a,{unit:"word"});break;case"insertLineBreak":case"insertParagraph":t.insertBreak(a);break;case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":s instanceof DataTransfer?ue.insertData(a,s):"string"==typeof s&&t.insertText(a,s)}}},onCompositionEnd:function(e,n,r){Ee(n,e.target)&&!Ce(e,r.onCompositionEnd)&&(r.isComposing=!1,f||c||!e.data||t.insertText(n,e.data))},onCompositionStart:function(e,t,n){Ee(t,e.target)&&!Ce(e,n.onCompositionStart)&&(n.isComposing=!0)},onKeyDown:function(e,a,o){if(!o.readOnly&&Ee(a,e.target)&&!Ce(e,o.onKeyDown)){var i=e,d=a.selection;if(w.isRedo(i))return e.preventDefault(),void(a.redo&&a.redo());if(w.isUndo(i))return e.preventDefault(),void(a.undo&&a.undo());if(w.isMoveLineBackward(i))return e.preventDefault(),void n.move(a,{unit:"line",reverse:!0});if(w.isMoveLineForward(i))return e.preventDefault(),void n.move(a,{unit:"line"});if(w.isExtendLineBackward(i))return e.preventDefault(),void n.move(a,{unit:"line",edge:"focus",reverse:!0});if(w.isExtendLineForward(i))return e.preventDefault(),void n.move(a,{unit:"line",edge:"focus"});if(w.isMoveBackward(i))return e.preventDefault(),void(d&&r.isCollapsed(d)?n.move(a,{reverse:!0}):n.collapse(a,{edge:"start"}));if(w.isMoveForward(i))return e.preventDefault(),void(d&&r.isCollapsed(d)?n.move(a):n.collapse(a,{edge:"end"}));if(w.isMoveWordBackward(i))return e.preventDefault(),void n.move(a,{unit:"word",reverse:!0});if(w.isMoveWordForward(i))return e.preventDefault(),void n.move(a,{unit:"word"});if(!Fe){if(w.isBold(i)||w.isItalic(i)||w.isTransposeCharacter(i))return void e.preventDefault();if(w.isSplitBlock(i))return e.preventDefault(),void t.insertBreak(a);if(w.isDeleteBackward(i))return e.preventDefault(),void(d&&r.isExpanded(d)?t.deleteFragment(a):t.deleteBackward(a));if(w.isDeleteForward(i))return e.preventDefault(),void(d&&r.isExpanded(d)?t.deleteFragment(a):t.deleteForward(a));if(w.isDeleteLineBackward(i))return e.preventDefault(),void(d&&r.isExpanded(d)?t.deleteFragment(a):t.deleteBackward(a,{unit:"line"}));if(w.isDeleteLineForward(i))return e.preventDefault(),void(d&&r.isExpanded(d)?t.deleteFragment(a):t.deleteForward(a,{unit:"line"}));if(w.isDeleteWordBackward(i))return e.preventDefault(),void(d&&r.isExpanded(d)?t.deleteFragment(a):t.deleteBackward(a,{unit:"word"}));if(w.isDeleteWordForward(i))return e.preventDefault(),void(d&&r.isExpanded(d)?t.deleteFragment(a):t.deleteForward(a,{unit:"word"}))}}},onFocus:function(e,t,n){if(!n.readOnly&&!n.isUpdatingSelection&&Ee(t,e.target)&&!Ce(e,n.onFocus)){var r=ue.toDOMNode(t,t);if(n.latestElement=window.document.activeElement,c&&e.target!==r)return void r.focus();ie.set(t,!0)}},onBlur:function(e,t,n){if(!n.readOnly&&!n.isUpdatingSelection&&Ee(t,e.target)&&Ce(e,n.onBlur)&&n.latestElement!==window.document.activeElement){var r=e.relatedTarget;if(!(r===ue.toDOMNode(t,t)||K(r)&&r.hasAttribute("data-slate-spacer"))){if(null!=r&&J(r)&&ue.hasDOMNode(t,r)){var a=ue.toSlateNode(t,r);if(d.isElement(a)&&!t.isVoid(a))return}ie.delete(t)}}},onCopy:function(e,t,n){Ee(t,e.target)&&!Ce(e,n.onCopy)&&(e.preventDefault(),ue.setFragmentData(t,e.clipboardData))},onPaste:function(e,t,n){Fe&&!V(e)||n.readOnly||!Ee(t,e.target)||Ce(e,n.onPaste)||(e.preventDefault(),ue.insertData(t,e.clipboardData))},onCut:function(e,n,a){if(!a.readOnly&&Ee(n,e.target)&&!Ce(e,a.onCut)){e.preventDefault(),ue.setFragmentData(n,e.clipboardData);var o=n.selection;o&&r.isExpanded(o)&&t.deleteFragment(n)}},onDragOver:function(e,n,r){if(xe(n,e.target)&&!Ce(e,r.onDragOver)){var a=ue.toSlateNode(n,e.target);t.isVoid(n,a)&&e.preventDefault()}},onDragStart:function(e,r,a){if(xe(r,e.target)&&!Ce(e,a.onDragStart)){var o=ue.toSlateNode(r,e.target),i=ue.findPath(r,o);if(t.void(r,{at:i})){var d=t.range(r,i);n.select(r,d)}ue.setFragmentData(r,e.clipboardData)}},onDrop:function(e,t,r){if(xe(t,e.target)&&!r.readOnly&&!Ce(e,r.onDrop)&&(!Fe||!f&&e.dataTransfer.files.length>0)){e.preventDefault();var a=ue.findEventRange(t,e),o=e.dataTransfer;n.select(t,a),ue.insertData(t,o)}},onSelectionchange:function(e,t){if(!t.readOnly&&!t.isComposing&&!t.isUpdatingSelection){var r=window.document.activeElement,a=ue.toDOMNode(e,e),o=window.getSelection();if(r===a?(t.latestElement=r,ie.set(e,!0)):ie.delete(e),!o)return n.deselect(e);var i=o.anchorNode,d=o.focusNode,l=Ee(e,i)||Oe(e,i),s=Ee(e,d)||Oe(e,d);if(l&&s){var c=ue.toSlateRange(e,o);n.select(e,c)}else n.deselect(e)}}};export{W as DOMComment,L as DOMElement,P as DOMNode,_ as DOMRange,j as DOMSelection,I as DOMStaticRange,R as DOMText,Z as EDITOR_TO_ELEMENT,ce as EDITOR_TO_GVM,de as EDITOR_TO_ON_CHANGE,ee as EDITOR_TO_PLACEHOLDER,te as ELEMENT_TO_NODE,Be as EditableComponent,fe as GVM_TO_EDITOR,w as Hotkeys,s as IS_APPLE,u as IS_EDGE_LEGACY,c as IS_FIREFOX,ie as IS_FOCUSED,l as IS_IOS,oe as IS_READ_ONLY,f as IS_SAFARI,ne as KEY_TO_ELEMENT,se as KEY_TO_VNODE,$ as Key,re as NODE_TO_ELEMENT,G as NODE_TO_INDEX,ae as NODE_TO_KEY,Q as NODE_TO_PARENT,le as PLACEHOLDER_SYMBOL,ue as VueEditor,A as addOnBeforeInput,H as getEditableChild,X as getPlainText,z as isDOMComment,K as isDOMElement,J as isDOMNode,U as isDOMText,V as isPlainTextOnlyPaste,q as normalizeDOMPoint,Se as withVue};
//# sourceMappingURL=index.es.js.map
